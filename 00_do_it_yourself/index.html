<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>My First VR World</title>
    <script src="aframe.min.js"></script>
    <style>
      /* einfacher Overlay-Play-Button für Autoplay-Fallback */
      html, body {
        height: 100%;
        margin: 0;
        background: transparent; /* keine Hintergrundfarbe */
      }
      #playOverlay {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0,0,0,0.6);
        z-index: 9999;
      }
      #playOverlay button {
        font-size: 1.25rem;
        padding: 0.8rem 1.2rem;
        border: none;
        border-radius: 8px;
        background: #1db954;
        color: white;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="playOverlay">
      <button id="playBtn">Play mit Ton</button>
    </div>

    <a-scene>
      <a-assets>
        <!-- ...existing code... -->
        <video id="trance" src="trance.mp4" autoplay loop playsinline webkit-playsinline crossorigin="anonymous"></video>
        <video id="mushrooms" src="mushrooms.mp4" autoplay loop muted playsinline webkit-playsinline crossorigin="anonymous"></video>
        <img id="wittgenstein" src="wittgenstein.jpg" crossorigin="anonymous">
        <!-- Afd_wtf-Video: kein "muted" hier, damit Ton verfügbar ist -->
        <video id="Afd_wtf" src="Afd_wtf.mp4" autoplay loop playsinline webkit-playsinline crossorigin="anonymous"></video>
        <!-- ...existing code... -->
      </a-assets>

      <!-- Würfel mit Video-Textur -->
      <a-box position="-1 0.5 1" rotation="0 45 0" width="1" height="1" depth="1" material="shader: flat; src: #trance"></a-box>

      <!-- Sky zeigt jetzt das Bild wittgenstein.jpg -->
      <a-sky id="bgSky" src="#wittgenstein" rotation="0 -90 0" material="shader: flat"></a-sky>

      <!-- Schwebender Text mit Zitat (blickt zur Kamera) -->
      <a-entity position="0 1.8 -2" look-at="#camera"
                text="value: Nicht wie die Welt ist, ist das Mystische, sondern dass sie ist.; align: center; color: #ffffff; width: 6; wrapCount: 36;"
                material="shader: flat; side: double">
      </a-entity>

      <!-- Neues schwebendes Zitat, 90° gedreht, sichtbar gegenüber der Kamera,
           neongrün und größer als das erste -->
      <a-entity position="2 1.2 -1" rotation="0 90 0">
        <a-entity look-at="#camera" scale="1.6 1.6 1.6"
                  text="value: Das Missverständnis ist die diplomatische Form der Ausrede.; align: center; color: #39FF14; width: 4; wrapCount: 24;"
                  material="shader: flat; side: double">
        </a-entity>
      </a-entity>

      <!-- NEUE ZITATE: verschiedene Stellen und Perspektiven -->

      <!-- 1) Großes, leicht erhöhtes Zitat, frontal zur Kamera -->
      <a-entity position="0 3 -4" look-at="#camera"
                text="value: Wir fühlen, dass, selbst wenn alle möglichen wissenschaftlichen Fragen beantwortet sind, unsere Lebensprobleme noch gar nicht berührt sind.; align: center; color: #FFD1FF; width: 8; wrapCount: 40;"
                material="shader: flat; side: double"
                animation="property: position; dir: alternate; dur: 4000; to: 0 3.2 -4; loop: true; easing: easeInOutQuad">
      </a-entity>

      <!-- 2) Schräg stehendes Zitat von der Seite, nicht zur Kamera ausgerichtet (andere Perspektive) -->
      <a-entity position="-2 1 -1.5" rotation="0 -40 10"
                text="value: Je schwächer das Argument, desto stärker die Worte.; align: left; color: #00FFFF; width: 3.5; wrapCount: 20;"
                material="shader: flat; side: double">
      </a-entity>

      <!-- 3) Kurzes, großes Zitat nahe am Würfel, leicht geneigt, schaut zur Kamera -->
      <a-entity position="-0.6 0.9 0.8" rotation="-10 0 0">
        <a-entity look-at="#camera" scale="1.8 1.8 1.8"
                  text="value: Auch Worte sind Taten.; align: center; color: #FFEE00; width: 2.8; wrapCount: 18;"
                  material="shader: flat; side: double">
        </a-entity>
      </a-entity>

      <!-- Neues Zitat: "Auch Gedanken fallen manchmal unreif vom Baum." -->
      <a-entity position="1 1.4 -1.5" rotation="0 -20 0" look-at="#camera"
                text="value: Auch Gedanken fallen manchmal unreif vom Baum.; align: center; color: #AAFFEE; width: 4; wrapCount: 30;"
                material="shader: flat; side: double">
      </a-entity>

      <!-- Plane mit Afd_wtf-Video als Textur (weiter links verschoben) -->
      <a-plane id="Afd_wtfPlane" position="-4 1 -3" rotation="0 0 0" width="4" height="2.25"
               material="shader: flat; src: #Afd_wtf; side: double; opacity: 1"></a-plane>

      <!-- Kamera mit Maus-Cursor damit Klicken möglich ist -->
      <a-entity position="0 0 3.8">
        <a-camera id="camera" cursor="rayOrigin: mouse">
          <a-cursor id="cursor" material="color: #ffffff; shader: flat; opacity: 0.95" geometry="radiusInner: 0.01; radiusOuter: 0.02"></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>

    <script>
      // ...existing code...
      const v = document.getElementById('trance');
      const overlay = document.getElementById('playOverlay');
      const btn = document.getElementById('playBtn');

      // Versuche automatisches Abspielen (wird in vielen Browsern mit Ton blockiert)
      if (v) {
        v.volume = 1.0;
        v.play().then(() => {
          v.muted = false;
        }).catch(() => {
          overlay.style.display = 'flex';
        });
      }

      btn.addEventListener('click', () => {
        overlay.style.display = 'none';
        if (v) {
          v.muted = false;
          v.play().catch(() => {});
        }
      });

      document.addEventListener('touchend', () => {
        if (overlay.style.display === 'flex') {
          overlay.style.display = 'none';
          if (v) { v.muted = false; v.play().catch(()=>{}); }
        }
      }, {passive: true});

      // Stroboskopischer Farbwechsel für den Hintergrund (Sky)
      (function setupStrobe() {
        const sky = document.getElementById('bgSky');
        if (!sky) return;

        const colors = ['#ffffff', '#ff0040', '#00ffea', '#39FF14', '#ffdd00', '#000000'];
        let step = 0;
        const intervalMs = 120; // Geschwindigkeit des Stroboskops (ms)

        function showImage() {
          // stelle Sky wieder auf Bild
          sky.setAttribute('src', '#wittgenstein');
          // entferne tint color damit Bild normal angezeigt wird
          sky.removeAttribute('color');
        }

        function showColor(c) {
          // entferne Bild und setze eine reine Farbe
          sky.removeAttribute('src');
          sky.setAttribute('color', c);
          sky.setAttribute('material', 'shader: flat');
        }

        // Startwert: Bild zeigen
        showImage();

        setInterval(() => {
          // abwechselnd Bild und Farbe anzeigen -> stroboskopischer Effekt
          if ((step % 2) === 0) {
            // Farbe anzeigen (wählt aus colors)
            const colorIndex = Math.floor(step / 2) % colors.length;
            showColor(colors[colorIndex]);
          } else {
            // Bild anzeigen
            showImage();
          }
          step++;
        }, intervalMs);
      })();

      // Sicherstellen, dass das Afd_wtf-Video zuverlässig im Loop startet
      (function ensureAfdWtfLoop(){
        const r = document.getElementById('Afd_wtf');
        if (!r) return;
        // Kein erzwungenes Autoplay mit Ton — Start erfolgt durch Nutzerinteraktion (click/keydown)
        // Dennoch: bei 'ended' neu starten
        r.addEventListener('ended', () => {
          try { r.currentTime = 0; r.play().catch(()=>{}); } catch (e) {}
        });
        // Falls es unbeabsichtigt pausiert, versuchen neu zu starten (ohne Autoplay erzwingen)
        r.addEventListener('pause', () => {
          if (!r.ended) {
            // versuchen, weiterzuspielen; wird ggf. blockiert bis Nutzer interagiert
            r.play().catch(()=>{});
          }
        });
      })();

      // Click-to-play / hover-highlight für Afd_wtf-Plane + keyboard input when hovered
      (function setupAfdWtfClick(){
        const plane = document.getElementById('Afd_wtfPlane');
        const video = document.getElementById('Afd_wtf');
        const cursor = document.getElementById('cursor');
        if (!plane || !video || !cursor) return;

        let isHovering = false;

        function updateCursorHoverState(hover) {
          isHovering = hover;
          if (hover) {
            cursor.setAttribute('material', 'color: #39FF14; shader: flat; opacity: 1');
            cursor.setAttribute('scale', '1.6 1.6 1.6');
            plane.setAttribute('material', 'opacity', 0.95);
          } else {
            cursor.setAttribute('material', 'color: #ffffff; shader: flat; opacity: 0.95');
            cursor.setAttribute('scale', '1 1 1');
            plane.setAttribute('material', 'opacity', 1.0);
          }
        }

        function togglePlayback() {
          if (video.paused) {
            // Nutzerinteraktion erlaubt Tonwiedergabe - entferne Muted falls gewünscht
            video.muted = false;
            video.volume = 1.0;
            video.play().catch(()=>{});
            cursor.setAttribute('material', 'color: #00ff00; opacity: 1');
          } else {
            video.pause();
            cursor.setAttribute('material', 'color: #ffffff; opacity: 0.95');
          }
          cursor.setAttribute('scale', '1.2 1.2 1.2');
          setTimeout(() => cursor.setAttribute('scale', '1 1 1'), 120);
        }

        plane.addEventListener('mouseenter', () => updateCursorHoverState(true));
        plane.addEventListener('mouseleave', () => updateCursorHoverState(false));
        plane.addEventListener('click', () => togglePlayback());

        // Keyboard: startet/stoppt Video nur wenn Cursor gerade über der Plane (grün)
        document.addEventListener('keydown', (e) => {
          if (!isHovering) return;
          if (e.key === 'Enter' || e.key === ' ' || e.key === 'Spacebar') {
            e.preventDefault();
            togglePlayback();
          }
        });
      })();
      // ...existing code...
    </script>
  </body>
</html>